# Docker 

## FastAPI Dockerfile 분석

![](./images/fastapi%20dockerfile.png)

- FROM python:3.11:
  - Docker 이미지를 생성할 때 사용할 기본 이미지(Base Image)를 지정합니다. 여기서는 Python 3.11을 기반 이미지로 사용합니다.
  - Python 3.11이 설치된 환경을 제공합니다.

- WORKDIR /code
  - 컨테이너 내에서 작업 디렉토리를 설정합니다. 이후의 명령어들은 이 디렉토리(/code)를 기준으로 실행됩니다.
  - 작업 디렉토리를 /code로 설정하여, 파일 복사 및 설치 작업 등이 이 디렉토리 내에서 이루어지도록 합니다.

- COPY ./requirements.txt /code/requirements.txt
  - 호스트 머신(로컬 컴퓨터)의 현재 디렉토리(./)에 있는 requirements.txt 파일을 컨테이너의 /code 디렉토리에 복사합니다.
  - 애플리케이션의 종속성 목록을 컨테이너로 복사하여 이후에 pip로 설치할 수 있도록 합니다.

- RUN pip install \
  - pip 명령어를 사용하여 패키지를 설치합니다. 이어지는 옵션 및 명령어는 \ 기호로 줄바꿈하여 계속됩니다.
  - 여러 줄에 걸쳐 pip 설치 명령어를 구성하여, 필요한 패키지를 설치합니다

-  --no-cache-dir \
  - pip 설치 시 캐시를 사용하지 않도록 합니다.
  - 설치 중에 디스크 공간을 절약하고, 캐시 관련 문제를 방지합니다.

- --upgrade \
  - 패키지를 설치할 때 최신 버전으로 업그레이드하도록 지정합니다.
  - 설치된 패키지의 최신 버전을 사용하여 최신 기능과 보안 패치를 적용합니다.

- -r /code/requirements.txt
  - requirements.txt 파일에 명시된 패키지들을 설치합니다
  - 프로젝트에 필요한 모든 종속성 패키지를 설치합니다.

- COPY ./app /code/app
  - 호스트 머신의 app 디렉토리를 컨테이너의 /code/app 디렉토리에 복사합니다
  - 애플리케이션의 소스 코드를 컨테이너로 복사하여 실행할 수 있도록 합니다.

- CMD [
  - 컨테이너가 시작될 때 실행할 명령어를 지정합니다. 명령어는 여러 줄로 나뉘어 있으며, 각 줄은 쉼표로 구분됩니다.
  - 컨테이너가 시작될 때 실행할 기본 명령어를 설정합니다.

- uvicorn
  - FastAPI 애플리케이션을 실행하기 위해 uvicorn 서버를 사용합니다
  - 애플리케이션 서버로 uvicorn을 사용하여 FastAPI 애플리케이션을 실행합니다.

- "app.main:app",
  - uvicorn이 실행할 애플리케이션 객체를 지정합니다. 여기서는 app 디렉토리의 main 모듈에서 app 객체를 찾습니다.
  - FastAPI 애플리케이션 객체를 지정하여 uvicorn이 이를 실행하도록 합니다

- "--host", "0.0.0.0",
  - uvicorn 서버가 모든 네트워크 인터페이스에서 연결을 수락하도록 설정합니다
  - 외부에서 컨테이너에 접근할 수 있도록 서버의 호스트를 0.0.0.0으로 설정합니다


- "--port", "8000"
  - uvicorn 서버가 8000번 포트에서 애플리케이션을 실행하도록 설정합니다.
  - FastAPI 애플리케이션이 8000번 포트에서 요청을 수락하도록 합니다.

- ]
  - CMD 명령어의 끝을 나타냅니다.
  - 컨테이너가 시작될 때 실행할 전체 명령어를 종료합니다


